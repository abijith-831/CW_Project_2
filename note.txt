Here is exactly how to store theme preference in Redux, sync it with localStorage, AND apply it to your <html> tag using Tailwindâ€™s dark mode (class).

Iâ€™ll give you:

âœ… 1. Update Redux Slice
âœ… 2. Updated useTheme() using Redux
âœ… 3. ThemeToggle component
âœ… 4. Apply theme on first load
âœ… 5. Full working flow
âœ… 1. Update authSlice to include theme_preference

Add a reducer to update theme inside Redux:

updateThemePreference(state, action: PayloadAction<"light" | "dark">) {
  if (state.currentUser) {
    state.currentUser.theme_preference = action.payload;
  }
}


âœ” Here is the updated slice:

import { createSlice, PayloadAction } from "@reduxjs/toolkit";

interface User {
  id: string;
  email: string;
  language_preference?: string;
  theme_preference?: "light" | "dark";
  capital_view?: string;
  selected_columns?: string[];
  search_query?: string;
}

interface UserState {
  currentUser: User | null;
  accessToken: string | null;
  refreshToken: string | null;
  error: boolean;
}

const initialState: UserState = {
  currentUser: null,
  accessToken: null,
  refreshToken: null,
  error: false,
};

const authSlice = createSlice({
  name: "auth",
  initialState,
  reducers: {
    loginSuccess(
      state,
      action: PayloadAction<{
        user: User;
        accessToken: string | null;
        refreshToken: string | null;
      }>
    ) {
      state.currentUser = action.payload.user;
      state.accessToken = action.payload.accessToken;
      state.refreshToken = action.payload.refreshToken;

      if (!state.currentUser.selected_columns) {
        state.currentUser.selected_columns = [
          "CompanyName",
          "CIN",
          "CompanyCategory",
          "CompanySubcategory",
          "CompanyStatus",
          "Registered_Office_Address",
        ];
      }
    },

    logout(state) {
      state.currentUser = null;
      state.accessToken = null;
      state.refreshToken = null;
      state.error = false;
    },

    updateCapitalView(state, action) {
      if (state.currentUser) {
        state.currentUser.capital_view = action.payload;
      }
    },

    updateSelectedColumns(state, action) {
      if (state.currentUser) {
        state.currentUser.selected_columns = action.payload;
      }
    },

    updateSearchQuery(state, action) {
      if (state.currentUser) {
        state.currentUser.search_query = action.payload;
      }
    },

    updateThemePreference(state, action: PayloadAction<"light" | "dark">) {
      if (state.currentUser) {
        state.currentUser.theme_preference = action.payload;
      }
    },

    setUser(state, action) {
      state.currentUser = action.payload;
    },

    setError(state) {
      state.error = true;
    },
  },
});

export const {
  loginSuccess,
  logout,
  setError,
  updateCapitalView,
  updateSelectedColumns,
  updateSearchQuery,
  updateThemePreference,
  setUser,
} = authSlice.actions;

export default authSlice.reducer;

âœ… 2. Updated useTheme() using Redux instead of localStorage

We will:

Read theme from Redux

Apply dark / light class on <html>

Save theme to Redux + localStorage

import { useEffect } from "react";
import { useDispatch, useSelector } from "react-redux";
import { updateThemePreference } from "./redux/slices/authSlice";

export const useTheme = () => {
  const dispatch = useDispatch();

  const theme =
    useSelector((state: any) => state.auth.currentUser?.theme_preference) ||
    "light";

  useEffect(() => {
    const html = document.documentElement;

    if (theme === "dark") html.classList.add("dark");
    else html.classList.remove("dark");

    localStorage.setItem("theme", theme);
  }, [theme]);

  const toggleTheme = () => {
    const newTheme = theme === "light" ? "dark" : "light";
    dispatch(updateThemePreference(newTheme));
  };

  return { theme, toggleTheme };
};

âœ… 3. ThemeToggle Component (Works with Redux now)
import { FaSun, FaMoon } from "react-icons/fa";
import { useTheme } from "../hooks/useTheme";

const ThemeToggle = () => {
  const { theme, toggleTheme } = useTheme();

  return (
    <button
      className="p-2 rounded-full bg-gray-200 hover:bg-gray-300 dark:bg-neutral-800 dark:hover:bg-neutral-700"
      onClick={toggleTheme}
    >
      {theme === "dark" ? <FaSun size={18} /> : <FaMoon size={18} />}
    </button>
  );
};

export default ThemeToggle;

âœ… 4. Apply Theme on App Start (so no flash of wrong theme)

In main.tsx:

import { useTheme } from "./hooks/useTheme";

function Root() {
  useTheme(); // apply theme before app renders
  return <App />;
}

ðŸŽ‰ RESULT: Your Theme System Now Works Like This

User clicks toggle â†’ Redux updates theme_preference

useTheme() sees Redux change

Updates <html class="dark">

Saves theme to localStorage for next reload

UI updates instantly

If you want, I can also:
âœ” Store theme in Supabase user profile
âœ” Sync theme across devices
âœ” Add system-theme support
âœ” Create animations for theme switch

Just tell me!